{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "image-crop-circular",
  "description": "Circular avatar cropper using the image crop component.",
  "registryDependencies": [
    "@loveui/image-crop",
    "@loveui/button",
    "@loveui/input"
  ],
  "files": [
    {
      "path": "registry/default/examples/image-crop-circular.tsx",
      "content": "\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport Image from \"next/image\"\nimport { XIcon } from \"lucide-react\"\n\nimport {\n  ImageCrop,\n  ImageCropApply,\n  ImageCropContent,\n  ImageCropReset,\n} from \"../../../../../packages/image-crop\"\nimport { Button } from \"../../../../../packages/ui/src/ui/button\"\n\nconst STOCK_IMAGES = [\n  {\n    label: \"Portrait\",\n    url: \"https://images.unsplash.com/photo-1544723795-3fb6469f5b39?auto=format&fit=crop&w=1200&q=80\",\n  },\n  {\n    label: \"Designer\",\n    url: \"https://images.unsplash.com/photo-1603415526960-f7e0328c63b1?auto=format&fit=crop&w=1200&q=80\",\n  },\n  {\n    label: \"Developer\",\n    url: \"https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=1200&q=80\",\n  },\n]\n\nconst getFileFromUrl = async (url: string, filename: string) => {\n  const response = await fetch(url)\n  if (!response.ok) {\n    throw new Error(\"Failed to fetch image\")\n  }\n\n  const blob = await response.blob()\n  const extension = blob.type.split(\"/\").at(-1) || \"jpg\"\n\n  return new File([blob], `${filename}.${extension}`, {\n    type: blob.type || \"image/jpeg\",\n  })\n}\n\nconst Example = () => {\n  const [selectedFile, setSelectedFile] = useState<File | null>(null)\n  const [croppedImage, setCroppedImage] = useState<string | null>(null)\n  const [activeIndex, setActiveIndex] = useState(0)\n  const [reloadKey, setReloadKey] = useState(0)\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  useEffect(() => {\n    let cancelled = false\n    const activeImage = STOCK_IMAGES[activeIndex]\n\n    const load = async () => {\n      setIsLoading(true)\n      setError(null)\n      setSelectedFile(null)\n\n      try {\n        const file = await getFileFromUrl(\n          activeImage.url,\n          activeImage.label.toLowerCase().replace(/\\s+/g, \"-\")\n        )\n\n        if (!cancelled) {\n          setSelectedFile(file)\n          setCroppedImage(null)\n        }\n      } catch (err) {\n        if (!cancelled) {\n          setError(\n            err instanceof Error ? err.message : \"Unable to load stock image.\"\n          )\n        }\n      } finally {\n        if (!cancelled) {\n          setIsLoading(false)\n        }\n      }\n    }\n\n    void load()\n\n    return () => {\n      cancelled = true\n    }\n  }, [activeIndex, reloadKey])\n\n  const handleReload = () => {\n    setReloadKey((key) => key + 1)\n  }\n\n  const handleReset = () => {\n    setCroppedImage(null)\n  }\n\n  const handleRetry = () => {\n    handleReload()\n  }\n\n  if (croppedImage) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"flex flex-wrap gap-2\">\n          {STOCK_IMAGES.map((image, index) => (\n            <Button\n              key={image.label}\n              onClick={() => setActiveIndex(index)}\n              size=\"sm\"\n              variant={index === activeIndex ? \"default\" : \"outline\"}\n            >\n              {image.label}\n            </Button>\n          ))}\n        </div>\n        <Image\n          alt=\"Cropped\"\n          className=\"overflow-hidden rounded-full\"\n          height={180}\n          src={croppedImage}\n          unoptimized\n          width={180}\n        />\n        <div className=\"flex gap-2\">\n          <Button\n            onClick={handleReset}\n            size=\"sm\"\n            type=\"button\"\n            variant=\"outline\"\n          >\n            Crop again\n          </Button>\n          <Button\n            onClick={() =>\n              setActiveIndex((index) => (index + 1) % STOCK_IMAGES.length)\n            }\n            size=\"sm\"\n            type=\"button\"\n            variant=\"outline\"\n          >\n            Use another portrait\n          </Button>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-wrap gap-2\">\n        {STOCK_IMAGES.map((image, index) => (\n          <Button\n            key={image.label}\n            disabled={isLoading && index === activeIndex}\n            onClick={() => setActiveIndex(index)}\n            size=\"sm\"\n            variant={index === activeIndex ? \"default\" : \"outline\"}\n          >\n            {image.label}\n          </Button>\n        ))}\n      </div>\n\n      {isLoading && (\n        <div className=\"h-52 w-full max-w-md animate-pulse rounded-full bg-muted\" />\n      )}\n\n      {error && (\n        <div className=\"flex items-center gap-2 rounded-lg border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive\">\n          <span>{error}</span>\n          <Button onClick={handleRetry} size=\"sm\" variant=\"ghost\">\n            Retry\n          </Button>\n        </div>\n      )}\n\n      {!selectedFile && !isLoading && !error && (\n        <p className=\"text-sm text-muted-foreground\">\n          Pick a portrait above to load the cropper.\n        </p>\n      )}\n\n      {selectedFile && !croppedImage && !isLoading && (\n        <ImageCrop\n          key={selectedFile?.name ?? \"stock-portrait\"}\n          aspect={1}\n          circularCrop\n          file={selectedFile}\n          maxImageSize={1024 * 1024} // 1MB\n          onChange={console.log}\n          onComplete={console.log}\n          onCrop={setCroppedImage}\n        >\n          <ImageCropContent className=\"max-w-md\" />\n          <div className=\"flex items-center gap-2\">\n            <ImageCropApply />\n            <ImageCropReset />\n            <Button\n              onClick={handleReload}\n              size=\"icon\"\n              type=\"button\"\n              variant=\"ghost\"\n            >\n              <XIcon className=\"size-4\" />\n            </Button>\n          </div>\n        </ImageCrop>\n      )}\n    </div>\n  )\n}\n\nexport default Example\n",
      "type": "registry:example"
    }
  ],
  "categories": [
    "media",
    "image",
    "crop"
  ],
  "type": "registry:example"
}